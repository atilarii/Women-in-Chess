{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "background": "#0f1720",
  "hconcat": [
    {
      "title": {
        "text": "Gender Pyramid",
        "color": "white"
      },
      "width": 600,
      "height": 700,
      "data": { "url": "data/International_Chess_Stats.csv" },
      "transform": [
        { "filter": "datum['Women'] >= 235" },
        { "calculate": "datum['Num Players'] - datum['Women']", "as": "Num_Men" },
        { "calculate": "-datum.Num_Men", "as": "Neg_Men" },
        { "window": [{"op": "rank", "as": "Country_order"}], "sort": [{"field": "% Women", "order": "descending"}] }
      ],
      "layer": [
        {
          "mark": {
            "type": "bar",
            "cornerRadius": 4
          },
          "encoding": {
            "y": {
              "field": "Country",
              "type": "ordinal",
              "sort": {"field": "Country_order", "order": "ascending"},
              "axis": { "labelColor": "white", "grid": true, "gridColor": "#f4f439", "gridOpacity": 0.3 }
            },
            "x": {
              "field": "Neg_Men",
              "type": "quantitative",
              "title": "Men",
              "axis": { "labelColor": "white", "titleColor": "white", "grid": false }
            },
            "color": { "value": "#0F52BA" },
            "tooltip": [
              { "field": "Country", "type": "nominal" },
              { "field": "Num_Men", "type": "quantitative", "title": "Men" },
              { "field": "Women", "type": "quantitative", "title": "Women" }
            ]
          }
        },
        {
          "mark": {
            "type": "bar",
            "cornerRadius": 4
          },
          "encoding": {
            "y": { "field": "Country", "type": "ordinal", "sort": {"field": "Country_order", "order": "ascending"} },
            "x": {
              "field": "Women",
              "type": "quantitative",
              "title": "Women"
            },
            "color": { "value": "#800080" },
            "tooltip": [
              { "field": "Country", "type": "nominal" },
              { "field": "Num_Men", "type": "quantitative", "title": "Men" },
              { "field": "Women", "type": "quantitative", "title": "Women" }
            ]
          }
        }
      ]
    },
    {
      "title": {
        "text": "% Women by Country",
        "color": "white"
      },
      "width": 200,
      "height": 700,
      "data": { "url": "data/International_Chess_Stats.csv" },
      "transform": [
        { "filter": "datum['Women'] >= 235" },
        { "window": [{"op": "rank", "as": "Country_order"}], "sort": [{"field": "Women", "order": "descending"}] }
      ],
      "mark": {
        "type": "line",
        "point": { "size": 60, "filled": true },
        "strokeWidth": 3,
        "color": "#FFD700"
      },
      "encoding": {
        "y": {
          "field": "Country",
          "type": "ordinal",
          "sort": {"field": "Num_Men", "order": "ascending"},
          "axis": { "labels": false, "ticks": false, "grid": true, "gridColor": "#f4f439", "gridOpacity": 0.2 }
        },
        "x": {
          "field": "% of Women",
          "type": "quantitative",
          "axis": { "title": "% Women", "labelColor": "white", "titleColor": "white" }
        },
        "tooltip": [
          { "field": "Country", "type": "nominal" },
          { "field": "% of Women", "type": "quantitative" }
        ]
      }
    }
  ],
  "config": {
    "view": { "stroke": "transparent", "fill": "#0f1720" }
  }
}
